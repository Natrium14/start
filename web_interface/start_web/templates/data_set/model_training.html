{% extends "data_set/index.html" %}

{% block data_set_content %}

<div style="margin-top: 10px">
    <ul class="nav nav-tabs">
      <li class="nav-item">
        <a class="nav-link" href="{% url 'index_dataset' %}">Загрузка данных</a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="{% url 'model_training' %}">Обучение модели</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{% url 'model_test' %}">Тестирование модели</a>
      </li>
    </ul>
</div>

<form method="POST" action="model_train">
    {% csrf_token %}
   <div class="form-group mb-2">
    <label for="methodSelect">Методы машинного обучения</label>
    <select multiple class="form-control" id="methodSelect" name="methodSelect">
      <option value="dbscan" onclick="show_parameters('dbscan')">DBSCAN</option>
      <option value="autoencoder" onclick="show_parameters('autoencoder')">Autoencoder</option>
    </select>
  </div>

  <div class="input-group input-group-sm mb-3" id="dbscan_params">
      <div class="input-group-prepend">
        <span class="input-group-text" id="inputGroup-sizing-sm1">eps</span>
      </div>
      <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm1" name="eps" placeholder="0.5">
      <div class="input-group-prepend">
        <span class="input-group-text" id="inputGroup-sizing-sm2">min_samples</span>
      </div>
      <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm2" name="min_samples" placeholder="2">
  </div>

{% if dataset_description is not None %}
      <div>
          Выбор полей для обучения модели:
          <p>
            {% for column in dataset_description %}
                <input type="checkbox" name="model_columns" value="{{ column }}">
                {{ column }}
                <br>
            {% endfor %}
            </p>
      </div>

      <button type="submit" class="btn btn-success">Обучить модель</button>
{% endif %}

</form>

{% if model_description %}

<div class="form-group mb-2">
    <b>Детали модели:</b>
    <br>
    {{ model_description }}
    <br>
    <b>Время обучения:</b>
    <span>{{ time_to_train }} сек.</span>
</div>

<a href="{% url 'vis_dbscan' %}" target="_blank" class="btn btn-primary">Визуализация результата</a>

<a href="{% url 'get_anomalies' %}" target="_blank" class="btn btn-danger">Список аномалий</a>

{% endif %}


<script>

    $(function(){$("#dbscan_params").hide();})

    function show_parameters(data){
        if (data == "dbscan") {
            $("#dbscan_params").show();
        }

        if (data == "autoencoder"){
            $("#dbscan_params").hide();
        }
    }

</script>



{% endblock %}